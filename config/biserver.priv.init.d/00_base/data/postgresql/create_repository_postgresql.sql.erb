-- DROP DATABASE IF EXISTS "<%= ENV['POSTGRES_HIBERNATE_DATABASE'] %>";
-- DROP USER IF EXISTS "<%= ENV['POSTGRES_HIBERNATE_USER'] %>";

DO $$
BEGIN
	CREATE USER "<%= ENV['POSTGRES_HIBERNATE_USER'] %>" PASSWORD '<%= ENV['POSTGRES_HIBERNATE_PASSWORD'] %>';
	EXCEPTION WHEN DUPLICATE_OBJECT THEN RAISE NOTICE 'User "<%= ENV['POSTGRES_HIBERNATE_USER'] %>" already exists';
END
$$;
CREATE DATABASE "<%= ENV['POSTGRES_HIBERNATE_DATABASE'] %>" WITH OWNER = "<%= ENV['POSTGRES_HIBERNATE_USER'] %>" ENCODING = 'UTF8' TABLESPACE = pg_default;
GRANT ALL PRIVILEGES ON DATABASE "<%= ENV['POSTGRES_HIBERNATE_DATABASE'] %>" TO "<%= ENV['POSTGRES_HIBERNATE_USER'] %>";
